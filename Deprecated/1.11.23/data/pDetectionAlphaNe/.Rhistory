group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1.1,
label = paste("P(detected > 0 times) : ",round(1- prob,3))),
hjust = 0.5, vjust = 1) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1))
breaksfun <- function(x){
1:max(x)
}
ggplot(dfdetected, aes(y=prob, x=as.factor(bin), color = selCoef,
group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1.1,
label = paste("P(detected > 0 times) : ",round(1- prob,3))),
hjust = 0.5, vjust = 1) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1))
ggplot(dfdetected, aes(y=prob, x=bin, color = selCoef,
group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1.1,
label = paste("P(detected > 0 times) : ",round(1- prob,3))),
hjust = 0.5, vjust = 1) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1))
ggplot(dfdetected, aes(y=prob, x=bin, color = selCoef,
group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1.1,
label = paste("P(detected > 0 times) : ",round(1- prob,3))),
hjust = 0.5, vjust = 1) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1)) +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1,
label = pdetected,
vjust = vjust)) +
guides(color=guide_legend(title = "Selection\nCoefficient",
override.aes = list(alpha=1)))
dfnotdetected <- df %>% filter(bin == 0) %>%
mutate(reps = as.factor(reps),
selCoef = as.factor(selCoef),
pdetected = paste("P(detected > 0 times) : ",formatC(round(1-prob,3),3,format="f"))) %>%
mutate(pdetected = as.factor(pdetected))
dfnotdetected$reps_number <- rep(c(3.5,
6.75,
9.75,
13),
each = 5)
dfnotdetected$vjust = rep((1.5 * 1:5), 4)
breaksfun <- function(x){
1:max(x)
}
ggplot(dfdetected, aes(y=prob, x=bin, color = selCoef,
group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1.1,
label = paste("P(detected > 0 times) : ",round(1- prob,3))),
hjust = 0.5, vjust = 1) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1)) +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1,
label = pdetected,
vjust = vjust)) +
guides(color=guide_legend(title = "Selection\nCoefficient",
override.aes = list(alpha=1)))
dfnotdetected$vjust = rep((1.5 * c(5,1,2,3,4)), 4)
breaksfun <- function(x){
1:max(x)
}
ggplot(dfdetected, aes(y=prob, x=bin, color = selCoef,
group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1.1,
label = paste("P(detected > 0 times) : ",round(1- prob,3))),
hjust = 0.5, vjust = 1) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1)) +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1,
label = pdetected,
vjust = vjust)) +
guides(color=guide_legend(title = "Selection\nCoefficient",
override.aes = list(alpha=1)))
rep(c(3.5,
6.75,
9.75,
13),
each = 5)
rep((1.5 * c(5,1,2,3,4)), 4)
ggplot(dfdetected, aes(y=prob, x=bin, color = selCoef,
group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1,
label = pdetected,
vjust = vjust)) +
guides(color=guide_legend(title = "Selection\nCoefficient",
override.aes = list(alpha=1))) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1))
dfnotdetected$vjust = rep((1.5 * c(4,5,1,2,3)), each = 4)
breaksfun <- function(x){
1:max(x)
}
ggplot(dfdetected, aes(y=prob, x=bin, color = selCoef,
group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1,
label = pdetected,
vjust = vjust)) +
guides(color=guide_legend(title = "Selection\nCoefficient",
override.aes = list(alpha=1))) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1))
dfnotdetected$vjust = rep((1.5 * c(4,5,1,2,3)), 4)
breaksfun <- function(x){
1:max(x)
}
ggplot(dfdetected, aes(y=prob, x=bin, color = selCoef,
group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1,
label = pdetected,
vjust = vjust)) +
guides(color=guide_legend(title = "Selection\nCoefficient",
override.aes = list(alpha=1))) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1))
dfnotdetected$reps_number <- rep(c(3.5,
6.75,
9.75,
13),
each = 5)
dfnotdetected$vjust = rep((1.5 * c(4,5,1,2,3)), 4)
breaksfun <- function(x){
1:max(x)
}
ggplot(dfdetected, aes(y=prob, x=bin, color = selCoef,
group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1,
label = pdetected,
vjust = vjust)) +
guides(color=guide_legend(title = "Selection\nCoefficient",
override.aes = list(alpha=1))) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1))
dfnotdetected <- df %>% filter(bin == 0) %>%
mutate(reps = as.factor(reps),
selCoef = as.factor(selCoef),
pdetected = paste("P(detected > 0 times) : ",formatC(round(1-prob,3),3,format="f"))) %>%
mutate(pdetected = as.factor(pdetected))
dfnotdetected$reps_number <- rep(c(3.5,
6.75,
9.75,
13),
each = 5)
dfnotdetected$reps_number <- rep(c(3.5,
6.75,
9.75,
13),
each = 5)
dfnotdetected$vjust = rep((1.5 * 1:5), 4)
breaksfun <- function(x){
1:max(x)
}
ggplot(dfdetected, aes(y=prob, x=bin, color = selCoef,
group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1,
label = pdetected,
vjust = vjust)) +
guides(color=guide_legend(title = "Selection\nCoefficient",
override.aes = list(alpha=1))) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1))
dfnotdetected$vjust = rep((1.5 * c(5,1,2,3,4)), 4)
breaksfun <- function(x){
1:max(x)
}
ggplot(dfdetected, aes(y=prob, x=bin, color = selCoef,
group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1,
label = pdetected,
vjust = vjust)) +
guides(color=guide_legend(title = "Selection\nCoefficient",
override.aes = list(alpha=1))) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1))
dfnotdetected$vjust = rep((1.5 * 1:5), 4)
breaksfun <- function(x){
1:max(x)
}
ggplot(dfdetected, aes(y=prob, x=bin, color = selCoef,
group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1,
label = pdetected,
vjust = vjust)) +
guides(color=guide_legend(title = "Selection\nCoefficient",
override.aes = list(alpha=1))) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1))
rm(list=ls())
rm(list=ls())
setwd("~/Documents/GitHub/path_integral/results/pDetectionAlphaNe")
list.files()
master <- data.frame()
for(file in list.files()){
tmp <- fread(file)
master <- dplyr::bind_rows(master, tmp)
}
names(master) <- c("selCoef", "Ne", "time", "start", "thresh", "totalP", "Pdetected")
master$popalpha = 2 * master$Ne * master$selCoef
rm(tmp)
# master <- master %>% filter(selCoef == 0.01)
master$reps = 4000 / master$Ne
df <- data.table()
for(i in 1:nrow(master)){
tmp <- master[i,]
for(j in 0:tmp$reps){
foo <- data.table(Ne = tmp$Ne,
reps = paste(tmp$reps,
" Replicates of Size ",
tmp$Ne),
selCoef = tmp$selCoef,
reps_number = tmp$reps,
bin = j,
prob = choose(tmp$reps, j) *
tmp$Pdetected^j *
(1 - tmp$Pdetected)^(tmp$reps - j))
df <- dplyr::bind_rows(df, foo)
}
}
rm(foo, master, tmp, file, i, j)
dfdetected <- df %>% filter(bin > 0) %>%
group_by(reps, selCoef) %>%
mutate(Pdetected = sum(prob)) %>%
mutate(prob = prob / Pdetected,
selCoef = as.factor(selCoef),
reps = as.factor(reps)) %>% ungroup()
dfdetected$reps <- factor(dfdetected$reps,
levels = levels(dfdetected$reps)[c(3,4,1,2)])
dfnotdetected <- df %>% filter(bin == 0) %>%
mutate(reps = as.factor(reps),
selCoef = as.factor(selCoef),
pdetected = paste("P(detected > 0 times) : ",formatC(round(1-prob,3),3,format="f"))) %>%
mutate(pdetected = as.factor(pdetected))
dfnotdetected$reps_number <- rep(c(3.5,
6.75,
9.75,
13),
each = 5)
dfnotdetected$vjust = rep((1.5 * 1:5), 4)
breaksfun <- function(x){
1:max(x)
}
ggplot(dfdetected, aes(y=prob, x=bin, color = selCoef,
group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1,
label = pdetected,
vjust = vjust)) +
guides(color=guide_legend(title = "Selection\nCoefficient",
override.aes = list(alpha=1))) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1))
dfnotdetected$vjust = rep((1.5 * c(2,3,4,5,1)), 4)
breaksfun <- function(x){
1:max(x)
}
ggplot(dfdetected, aes(y=prob, x=bin, color = selCoef,
group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1,
label = pdetected,
vjust = vjust)) +
guides(color=guide_legend(title = "Selection\nCoefficient",
override.aes = list(alpha=1))) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1))
dfnotdetected$reps
dfnotdetected$reps_number <- rep(c(3.5,
13,
9.75,
6.75),
each = 5)
dfnotdetected$vjust = rep((1.5 * c(2,3,4,5,1)), 4)
breaksfun <- function(x){
1:max(x)
}
ggplot(dfdetected, aes(y=prob, x=bin, color = selCoef,
group = selCoef)) +
geom_line(alpha = 0.6,
size = 1.5) +
geom_point(alpha=1,
size = 2.5) +
facet_wrap(~ factor(reps, levels = unique(dfdetected$reps)[c(1,4,3,2)]), scales="free_x") +
theme_bw() +
scale_x_continuous(breaks = breaksfun) +
scale_color_viridis(discrete = T) +
xlab("Number of Replicates Detected") +
ylab("Probability Given Detected at least Once") +
geom_text(data = dfnotdetected, aes(x = reps_number,
y = 1,
label = pdetected,
vjust = vjust)) +
guides(color=guide_legend(title = "Selection\nCoefficient",
override.aes = list(alpha=1))) +
theme(panel.grid.minor = element_blank(),
axis.title = element_text(size=18),
axis.text.x = element_text(size = 12),
legend.text = element_text(size = 12)) +
scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1))
